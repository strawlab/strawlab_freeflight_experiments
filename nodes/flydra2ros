#!/usr/bin/env python

# ROS imports
import roslib; roslib.load_manifest('strawlab_freeflight_experiments')
from ros_flydra.msg import flydra_mainbrain_super_packet
from geometry_msgs.msg import Pose
import rospy

import display_client

class Node(object):
    def __init__(self):
        rospy.init_node('flydra2ros')
        rospy.Subscriber("flydra_mainbrain_super_packets",
                         flydra_mainbrain_super_packet,
                         self.tracking_data_callback)
        self.pub = rospy.Publisher('pose', Pose)

    def run(self):
        rospy.spin()

    def tracking_data_callback(self,data):
        for packet in data.packets:
            framenumber = packet.framenumber
            for obj in packet.objects:
                # FIXME: should check and lock on to objects obj.obj_id
                print 'obj_id:',obj.obj_id
                msg = Pose()
                msg.position.x=obj.position.x
                msg.position.y=obj.position.y
                msg.position.z=obj.position.z
                self.pub.publish(msg)

if __name__ == '__main__':
    n = Node()
    n.run()



