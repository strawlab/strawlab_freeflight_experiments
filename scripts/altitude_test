#!/usr/bin/env python
import numpy as np
import sys

# ROS imports ############################
import roslib; roslib.load_manifest('strawlab_freeflight_experiments')
import rospy
from std_msgs.msg import Float32

import display_client # from vros_projectors package


class Node(object):
    def __init__(self):
        rospy.init_node("altitude_test")
        self.display_server = display_client.DisplayServerProxy()
        self.display_server.set_mode('StimulusAltitudeEdge')
        self.pub = rospy.Publisher('edge_height', Float32)

    def run(self):
        r = rospy.Rate(200) # 200hz
        while not rospy.is_shutdown():
            #self.step()
            t = rospy.get_time()
            msg = Float32()
            msg.data = np.sin(0.1 * 2*np.pi*t)*0.5+.5
            self.pub.publish(msg)
            r.sleep()

def main():
    node = Node()
    return node.run()

if __name__=='__main__':
    main()
